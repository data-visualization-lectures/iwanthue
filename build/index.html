<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js"> <!--<![endif]-->

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>iWantHue</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width">

    		<link rel="stylesheet" href="/css/bootstrap.min.css">
        <link rel="stylesheet" href="/css/bootstrap-responsive.min.css">
        <link rel="stylesheet" href="/css/prettify.css">

        <link rel="stylesheet" href="/css/main.css">

        <script src="/js/libs/modernizr-2.6.1-respond-1.1.0.min.js"></script>
        <script src="/js/supabase.js"></script>
        <script src="/js/dataviz-auth-client.js"></script>
        <!-- Google tag (gtag.js) -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-5XGC6LE2KY"></script>
        <script>
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
        
          gtag('config', 'G-5XGC6LE2KY');
        </script>


    <style>
        body {
            padding-bottom: 40px;
        }
    </style>

</head>

<body>
    <!--[if lt IE 7]>
            <p class="chromeframe">You are using an outdated browser. <a href="http://browsehappy.com/">Upgrade your browser today</a> or <a href="http://www.google.com/chromeframe/?redirect=true">install Google Chrome Frame</a> to better experience this site.</p>
        <![endif]-->

    <div class="navbar navbar-inverse navbar-static-top">
    <div class="navbar-inner">
        <div class="container">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>
            <a class="brand" href="/">I want hue</a>
            <div class="nav-collapse collapse">
                <ul class="nav">
                    <li><a href="/tutorial/">チュートリアル</a></li>
                    <li><a href="/examples/">例</a></li>
                    <li><a href="/theory/">理論</a></li>
                    <li><a href="/experiment/">実験</a></li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Old version <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            <li><a href="/palettes/">Generate</a></li>
                            <li><a href="/corrector/">Correct</a></li>
                            <li><a href="/completion/">Complete</a></li>
                        </ul>
                    </li>
                </ul>
                <div class="pull-right">
                </div>

            </div><!--/.nav-collapse -->
        </div>
    </div>
</div>

    <div class="container">

        <!-- Main hero unit for a primary marketing message or call to action -->
        <div class="splash-unit row">
            <div class="span7">
                <div class="image">
                    <a href="/"><img src="/res/header.png" /></a>
                </div>
                <div class="title">
                    i want hue
                </div>
            </div>
            <div class="span5">
                <div class="abstract">
                    <p><strong>データサイエンティストのための色。</strong> 最適に区別可能な色のパレットを生成・調整します。</p>
                </div>
            </div>
        </div>
    </div>


    <div id="workbench">
        <div class="container">
            <div class="row">
                <div class="span9 spacetitle">
                    <h3>カラー・スペース</h3>
                </div>
                <div class="span3 spacetitle">
                    <h3>パレット</h3>
                </div>
            </div>
            <div class="row unselectable">
                <div class="span4">
                    <select id="presets" onchange="updateSettings()">
                        <option>Presets...</option>
                    </select>
                    <table id="selectorsTable" style="width: 100%;">
                        <tr>
                            <td>
                                <div class="input-append input-prepend"><span title="Hue" class="add-on">H</span><input
                                        id="hmin" type="text" value="0" style="width:30px;" /></div>
                            </td>
                            <td style="width: 100%;">
                                <div id="hueSelector"></div>
                            </td>
                            <td>
                                <div class="input-prepend"><input id="hmax" type="text" value="360"
                                        style="width:30px;" /></div>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <div class="input-append input-prepend"><span title="Chroma (from gray to colorfull)"
                                        class="add-on">C</span><input id="cmin" type="text" value="0"
                                        style="width:30px;" /></div>
                            </td>
                            <td>
                                <div id="chromaSelector"></div>
                            </td>
                            <td>
                                <div class="input-prepend"><input id="cmax" type="text" value="10"
                                        style="width:30px;" /></div>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <div class="input-append input-prepend"><span title="Lightness"
                                        class="add-on">L</span><input id="lmin" type="text" value="0"
                                        style="width:30px;" /></div>
                            </td>
                            <td>
                                <div id="lightnessSelector"></div>
                            </td>
                            <td>
                                <div class="input-prepend"><input id="lmax" type="text" value="10"
                                        style="width:30px;" /></div>
                            </td>
                        </tr>
                    </table>
                    <br />
                    <label class="checkbox">
                        <input type="checkbox" id="colorblindFriendly" onchange="setting_toggle()" />
                        <strong>色覚異常</strong>への配慮を改善（処理が遅くなります）
                    </label>
                    <label class="checkbox">
                        <input type="checkbox" id="darkBackground" /> 暗い背景
                    </label>
                </div>
                <div class="span5">
                    <div id="carto">...</div>
                </div>
                <div class="span3">

                    <div class="row">
                        <div class="input-append span1">
                            <input id="colorsCount" type="text" value="5" style="width:20px;" />
                            <span class="add-on">colors</span>
                        </div>
                        <div class="span2">
                            <select id="algo" class="span2">
                                <option value="kmeans" selected=true>soft (k-Means)</option>
                                <option value="forcevector">hard (Force vector)</option>
                            </select>
                        </div>
                    </div>

                    <button class="btn" id="reduceToPalette" style="width: 100%" onclick="reduceToPalette();"><i
                            class="icon-hand-right"></i> パレットを作る</button>

                    <div id="palette_visual">
                    </div>

                    <div id="palette_visual_sort">
                        <small>Sort by</small>
                        <button class="btn btn-small btn-link" onclick="sortPalette('difference')">diff</button>
                        <button class="btn btn-small btn-link" onclick="sortPalette('hue')">hue</button>
                        <button class="btn btn-small btn-link" onclick="sortPalette('chroma')">chroma</button>
                        <button class="btn btn-small btn-link" onclick="sortPalette('lightness')">lightness</button>
                        <button class="btn btn-small btn-link" onclick="sortPalette('random')">random</button>
                    </div>

                    <div class="unselectable">
                        <div id="refine" style="/*display:none;*/">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="container" style="display: none" id="resultColors_container">
        <div class="row">
            <div class="span6">
                <h3>Colors</h3>
                <div id="resultColors">
                    <span class="muted">パレットを作成してください</span>
                </div>
                <div id="additionalInfo">
                </div>
            </div>
            <div class="span6">
                <div class="row">
                    <div class="span3">
                        <h3>JSON</h3>
                        <h5>16進数 json</h5>
                        <div id="resultColors_hexjson">
                            <span class="muted">パレットを作成してください</span>
                        </div>
                        <h5>RGB json</h5>
                        <div id="resultColors_rgbjson">
                            <span class="muted">パレットを作成してください</span>
                        </div>
                        <h5>HCL json</h5>
                        <div id="resultColors_hcljson">
                            <span class="muted">パレットを作成してください</span>
                        </div>
                        <h5>LAB json</h5>
                        <div id="resultColors_labjson">
                            <span class="muted">パレットを作成してください</span>
                        </div>
                    </div>
                    <div class="span3">
                        <h3>CSS</h3>
                        <h5>HEX list for CSS</h5>
                        <div id="resultColors_hexlist">
                            <span class="muted">パレットを作成してください</span>
                        </div>
                        <h5>RGB list for CSS</h5>
                        <div id="resultColors_rgblist">
                            <span class="muted">パレットを作成してください</span>
                        </div>
                    </div>
                </div>

                <h3>Javascript</h3>
                <h5>この設定でパレットを生成するスクリプト</h5>
                <div id="resultColors_jsGeneration">
                    <span class="muted">パレットを作成してください</span>
                </div>
            </div>
        </div>
    </div>


            <div class="container">

            <hr>

            <footer>
                <div class="row">
                    <div class="span4">
                        <p>
                            <a href="https://twitter.com/share" class="twitter-share-button" data-text="iWantHue: make clever color palettes">Tweet</a>
                            <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="https://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
                        </p>

                        <p>
                            We used:
                            <br/>
                            <strong><a href="http://sigmajs.org/">Sigma.js</a></strong>,
                            <a href="http://code.google.com/p/google-code-prettify/">Prettify</a>,
                            <a href="http://twitter.github.com/bootstrap/">Bootstrap</a>,
                            <a href="http://jquery.com/">jQuery</a>,
                            <a href="http://modernizr.com/">Modernizr</a>,
                            <a href="http://www.initializr.com/">Initializr</a>
                        </p>
                        <p>
                            Check our <a href="https://github.com/medialab/iwanthue">GitHub</a>.
                        </p>

                    </div>
                    <div class="span4">
                        <p>See also our other tools at <strong><a href="http://tools.medialab.sciences-po.fr">Médialab Tools</a></strong>!</p>
                        <p>And a huge <strong>thanks</strong> to these inspiring works:</p>
                        <strong><a href="https://github.com/gka/chroma.js">Chroma.js</a></strong>
                        <p>
                            I massively use this excellent js library to convert colors.
                            If you have not done it yet, look at <a href="http://vis4.net/blog/posts/avoid-equidistant-hsv-colors/">this post</a>. You'll understand much useful things about color in dataviz.
                        </p>
                        <strong><a href="http://colorbrewer2.org/">ColorBrewer</a></strong>
                        <p>
                            Very famous tool, that showed the way few years ago. If you do not know it, you <i>must</i> take a look.
                        </p>
                    </div>
                    <div class="span4">
                        <div style="text-align:right">
                            <a href="http://medialab.sciences-po.fr"><img src="/res/logosp_fonce.png"/></a>
                            <p class="muted">
                                Developed by Mathieu Jacomy
                                <br/>
                                at the <a href="http://medialab.sciences-po.fr">Sciences-Po Medialab</a>
                            </p>
                            <p>
                                Help, bug report or contacting us:
                                <br/>
                                <i class="icon-hand-right"></i> <a href="https://github.com/medialab/iwanthue/issues">GitHub Issues</a>.
                            </p>
                        </div>
                    </div>
                </div>
            </footer>
        </div>



    <!-- Color Picker Modal -->
    <div id="colorPicker_modal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
        aria-hidden="true">
        <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
            <h3 id="myModalLabel">カラー・ピッカー</h3>
        </div>
        <div class="modal-body">
            <table>
                <tr>
                    <td>
                        <div id="colorpicker_abContainer" class="unselectable"></div>
                    </td>
                    <td>
                        <table>
                            <tr>
                                <td style="padding-left: 20px">
                                    <table>
                                        <tr>
                                            <td>
                                                <div class="input-append input-prepend"><span title="Hue"
                                                        class="add-on">H</span><input id="colorpicker_hInput"
                                                        type="text" value="0" style="width:36px;" /></div>
                                            </td>
                                            <td>
                                                <div id="colorpicker_hContainer" class="unselectable"></div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <div class="input-append input-prepend"><span
                                                        title="Chroma (from gray to colorfull)"
                                                        class="add-on">C</span><input id="colorpicker_cInput"
                                                        type="text" value="0" style="width:36px;" /></div>
                                            </td>
                                            <td>
                                                <div id="colorpicker_cContainer" class="unselectable"></div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <div class="input-append input-prepend"><span title="Lightness"
                                                        class="add-on">L</span><input id="colorpicker_lInput"
                                                        type="text" value="0" style="width:36px;" /></div>
                                            </td>
                                            <td>
                                                <div id="colorpicker_lContainer" class="unselectable"></div>
                                            </td>
                                        </tr>
                                        <tr>
                                    </table>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <table>
                                        <tr>
                                            <td>
                                                <div class="input-append input-prepend"><input id="colorpicker_aInput"
                                                        type="text" value="0" style="width:36px;" /><span
                                                        title="a* color axis, from Red to Green" class="add-on">A</span>
                                                </div>
                                            </td>
                                            <td>
                                                <div class="input-append input-prepend"><input id="colorpicker_bInput"
                                                        type="text" value="0" style="width:36px;" /><span
                                                        title="b* color axis, from Blue to Yellow"
                                                        class="add-on">B</span></div>
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>
                        </table>
                    </td>
                    <td>
                        <table>
                            <tr>
                                <td>
                                    <div id="colorpicker_renderContainer"></div>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <div style="height: 38px" class="pull-right">
                                        <div class="input-prepend"><span class="add-on">Hex</span><input
                                                id="colorpicker_hexInput" type="text" value="#" style="width:60px;" />
                                        </div>
                                    </div>
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>
            </table>
        </div>
        <div class="modal-footer">
            <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
            <button class="btn btn-primary" id="colorPicker_pickButton">Pick color</button>
        </div>
    </div>
    
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="/js/libs/jquery-1.8.0.min.js"><\/script>')</script>

<script src="/js/libs/bootstrap.min.js"></script>

<script src="/js/libs/chroma.min.js"></script>
<script src="/js/libs/chroma.palette-gen.js"></script>

<!-- Matomo -->
<script type="text/javascript">
  var _paq = window._paq = window._paq || [];
  /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
  _paq.push(['setDoNotTrack', true]);
  _paq.push(['disableCookies']);
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u='https://ws.sciences-po.fr/';
    _paq.push(['setTrackerUrl', u+'matomo.php']);
    _paq.push(['setSiteId', '20']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.type='text/javascript'; g.async=true; g.src=u+'matomo.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
<noscript><p><img src="https://ws.sciences-po.fr/matomo.php?idsite=20&amp;rec=1" style="border:0;" alt="" /></p></noscript>
<!-- End Matomo Code -->


    <script src="/js/libs/prettify.js"></script>

    <script src="/js/libs/FileSaver.js"></script>

    <script src="/js/libs/sigma.min.js"></script>
    <script src="/js/libs/sigma.layout.forceAtlas2.min.js"></script>

    <script src="/js/background.js"></script>
    <script src="/js/colorspace.js"></script>
    <script src="/js/presets.js"></script>
    <script src="/js/selectors.js"></script>
    <script src="/js/fitting.js"></script>
    <script src="/js/palettegeneration.js"></script>
    <script src="/js/colorpicker.js"></script>

    <script src="/js/sandbox.js"></script>

    <script>

        $(document).ready(function () {
            // Init selectors fields
            $('#hmin').val(0);
            $('#hmax').val(360);
            $('#cmin').val(0);
            $('#cmax').val(3);
            $('#lmin').val(0);
            $('#lmax').val(1.5);
            $('#colorsCount').val(5);

            initSelectors()
            colorpicker.init()
            updateColorSpace()
            initVisualPalette()
            initPresets(1)
        });

        // Init the color samples once for all
        console.log("Initializing color sampling...")
        var colorSamples = []
        var lstep = 3
        var astep = 8
        var bstep = 8
        var colorsIndex = {}
        for (l = 0; l <= 100; l += lstep) {
            for (a = 0; a <= 100; a += astep) {
                for (b = 0; b <= 100; b += bstep) {
                    sampleColor([l, +a, +b])
                    sampleColor([l, -a, +b])
                    sampleColor([l, +a, -b])
                    sampleColor([l, -a, -b])
                }
            }
        }
        function sampleColor(lab) {
            // Test if color exists in lab space
            if (paletteGenerator.validateLab(lab)) {
                var color = chroma.lab(lab)
                // Test if the color does not exist already (there are weird boundaries to the CIE Labs space)
                if (colorsIndex[color.hex()]) {
                    // Color already exists
                } else {
                    colorSamples.push({ color: color, hex: color.hex(), lab: color.lab(), hcl: color.hcl(), rgb: color.rgb() })
                    colorsIndex[color.hex()] = true
                }
            }
        }
        console.log("...done")

        /// PALETTE GENERATION
        $('#colorsCount').change(function () {
            initVisualPalette()
        })

        /// COLOR SPACE
        $('#hmin, #hmax, #cmin, #cmax, #lmin, #lmax').change(function () {
            var width = $("#hueSelector").width();

            selectorsState.hue.min = parseFloat($('#hmin').val()) / 360;
            selectorsState.hue.max = parseFloat($('#hmax').val()) / 360;
            selectorsState.chroma.min = parseFloat($('#cmin').val()) / maxChroma;
            selectorsState.chroma.max = parseFloat($('#cmax').val()) / maxChroma;
            selectorsState.lightness.min = parseFloat($('#lmin').val()) / maxLightness;
            selectorsState.lightness.max = parseFloat($('#lmax').val()) / maxLightness;

            // Avoid null ranges
            if (selectorsState.hue.max - selectorsState.hue.min < 1 / 360) {
                selectorsState.hue.max = selectorsState.hue.min + 1 / 360
            }
            if (selectorsState.chroma.max - selectorsState.chroma.min < .2 / maxChroma) {
                selectorsState.chroma.max = selectorsState.chroma.min + .2 / maxChroma
                $('#cmax').val(selectorsState.chroma.max * maxChroma)
            }
            if (selectorsState.lightness.max - selectorsState.lightness.min < .1 / maxLightness) {
                selectorsState.lightness.max = selectorsState.lightness.min + .1 / maxLightness
                $('#lmax').val(selectorsState.lightness.max * maxLightness)
            }

            updateSelectors();
            updateColorSpace();
        })

        // Colors network
        var s;
        var forceStopTimers = [];
        var initSigma = function () {
            // Clean old sigma instances if needed
            for (sid in sigma.instances()) {
                var sInstance = sigma.instances()[sid]
                sInstance.stopForceAtlas2()
                sInstance.graph.clear()
                sInstance.kill()
            }
            $('#carto').empty()
            forceStopTimers.forEach(function (t) {
                clearTimeout(t)
            })

            // INIT SIGMA
            s = new sigma({
                container: 'carto'
                , settings: {
                    // Labels:
                    font: "'Arial', sans-serif;",
                    defaultLabelColor: '#333',
                    defaultLabelSize: 16,
                    defaultLabelBGColor: '#fff',
                    defaultLabelHoverColor: '#000',
                    labelThreshold: 100,

                    // Edges
                    defaultEdgeType: 'line',
                    drawEdges: false,

                    maxNodeSize: 8,

                    mouseEnabled: false,
                    blockScroll: true,
                    minRatio: 1,
                    maxRatio: 1
                }
            });

            // Mouse actions
            s.bind('overnodes', function (e) {
                // Cursor: pointer for hovered nodes
                $('#carto').addClass("nodehovered");    // Actually, the whole canvas has the property
            });
            s.bind('outnodes', function (e) {
                // Remove the pointer cursor on node out
                $('#carto').removeClass("nodehovered");
            });
        }

        // Init network viz (sigma)
        initSigma();

        // Dynamic resize update
        window.onresize = function () {
            resizeWidget();
        }

        // Resize graph
        var resizeWidget = function () {
            // s.refresh();
            s.render();
            updateSelectors();
        }

        // Background
        $('#darkBackground').click(function () {
            updateBackground();
        });

        // Presets
        presets.forEach(function (preset, i) {
            $('#presets').append('<option value="' + i + '">' + preset.name + '</option>');
        });

        // No selection on certain parts of the interface
        $('.unselectable').attr('unselectable', 'on')
            .css({
                '-moz-user-select': 'none',
                '-webkit-user-select': 'none',
                'user-select': 'none',
                '-ms-user-select': 'none'
            })
            .each(function () {
                this.onselectstart = function () { return false; };
            });

    </script>

</body>

</html>